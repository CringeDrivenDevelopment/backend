# Muse Backend

## API TODO:
- Permissions + данные с тг (я сделаю, либо вместе) (след неделя)
- playlist export (след неделя) (based on hash)
- R2 под ассеты не под авторским правом (любой другой S3)
- logger (никогда)
- normal errors (никогда)
- Комменты + Дока (никогда)
- тесты (никогда)

## Bot TODO
- действия в чате/канале при добавлении
- config
- logger

## Запуск
```shell
# 1. докер прям надо
docker compose -f dev-compose.yml up -d

# 2. Запуск
go run cmd/main.go
```

## Структура проекта
```shell
.
├── Dockerfile # схема-чертёж для сборки Docker
├── cmd # здесь вход в программу
│ ├── app/app.go # тут создаём само приложение и настраиваем, тесты сделаю))
│ └── main.go # основная точка, AKA main
├── dev-compose.yml # здесь мы прописываем зависимости
├── dev.env # тут надо прописать настройки
├── go.mod # здесь прописываем библиотеки, которые надо поставить
├── go.sum # это не трогать, оно генерится
├── internal
│ ├── adapters
│ │ ├── config/config.go
│ │ ├── controller
│ │ │ ├── middlewares/jwt.go
│ │ │ ├── playlist.go
│ │ │ ├── setup.go
│ │ │ ├── track.go
│ │ │ ├── user.go
│ │ │ └── validator/validator.go # валидация запросов
│ │ └── repository # это не трогать, юз)ать можно, это сгенеренный код (НЕ НЕЙРОНКОЙ
│ │     ├── db.go
│ │     ├── models.go
│ │     └── schema.sql.go
│ └── domain
│     ├── dto # здесь модельки разные, т.е. гошные структуры с прописанными маппингами под JSON
│     │ ├── ping.go
│     │ ├── playlist.go
│     │ ├── token.go
│     │ ├── track.go
│     │ └── user.go
│     ├── service # здесь прописывается логика процесса, т.е. что и как сделать
│     │ ├── playlist.go
│     │ ├── token.go
│     │ ├── user.go
│     │ └── youtube.go
│     └── utils
│         ├── connection.go
│         └── telegram.go
├── sql/schema.sql # сырые SQL команды
└── sqlc.yml # конфиг для генерации обёртки над SQL кодом
```

# Roles
- owner (создатель плейлиста, может аппрувить треки и удалить плейлист ЕСТЬ НЮАНС СМ Types)
- moderator (модератор, может аппрувить треки)
- viewer (юзер, может просто кидать треки на аппрув)
## Как получить
- owner выдаётся, если юзер - владелец канала или чата.
- moderator выдаётся, если юзер - администратор чата или канала (есть хотя бы подпись админа)
- viewer выдаётся, если юзер - член чата или канала
- роль убирается, если юзера забанят или он ливнет с чата

# Types
- custom (создан через миниапп, добавлять людей нельзя, но можно удалить вручную)
- tg (создаётся, если добавить бота в группу, удалить можно только удалив бота из группы, автоматически подгружает роли для юзеров из группы в тг)

# user story без нашего решения (сбор через гугл формы):
- нужно собирать треки вручную
- нет возможности пользователю сразу указать какой трек нужен (если нет возможности приложить ссылку)
- модерация треков слишком сложная (нужно найти трек, если не указана ссылка)
- скачивание сложное (нужно писать скрипты для загрузки аудио, нет единой площадки)

# user story с нашим решением
- автоматическая система ролей (легко сделать модерацию от кучи людей)
- одна площадка
- лёгкая загрузка треков
- сразу можно увидеть информацию про трек
- пользователь может быть уверен, что скинет точно тот трек, который хотел

# плюсы
процесс поиска трека по названию автоматизирован и сразу видно информацию о треке, 
то модераторы могут не тратить на это время, а значит основная задача - упрощение, выполнена

можно не тратить время на поиск треков на сторонних площадках и на поиск ссылки на их скачивание